"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "rpc", {
    enumerable: true,
    get: function() {
        return rpc;
    }
});
const _chopstickscore = require("@acala-network/chopsticks-core");
const _zod = require("zod");
const _index = require("../../schema/index.js");
const schema = _index.zHash.or(_zod.z.number());
const rpc = async (context, [params])=>{
    const hashOrNumber = schema.parse(params);
    let block;
    if (typeof hashOrNumber === 'number') {
        const blockNumber = hashOrNumber > 0 ? hashOrNumber : context.chain.head.number + hashOrNumber;
        block = await context.chain.getBlockAt(blockNumber);
    } else {
        block = await context.chain.getBlock(hashOrNumber);
    }
    if (!block) {
        throw new _chopstickscore.ResponseError(1, `Block not found ${hashOrNumber}`);
    }
    await context.chain.setHead(block);
    return block.hash;
};
