import {
  importAsyncConfig
} from "./chunk-3IRCD3RX.js";

// src/lib/rpcFunctions.ts
import fetch from "node-fetch";
async function customDevRpcRequest(method, params = []) {
  const globalConfig = await importAsyncConfig();
  const env = globalConfig.environments.find(({ name }) => name == process.env.MOON_TEST_ENV);
  const endpoint = env.connections ? env.connections[0].endpoints[0].replace("ws://", "http://") : `http://127.0.0.1:${1e4 + Number(process.env.VITEST_POOL_ID || 1) * 100}`;
  const data = {
    jsonrpc: "2.0",
    id: 1,
    method,
    params
  };
  const response = await fetch(endpoint, {
    method: "POST",
    body: JSON.stringify(data),
    headers: { "Content-Type": "application/json" }
  });
  const responseData = await response.json();
  if (responseData.error) {
    throw new Error(responseData.error.message);
  }
  return responseData.result;
}

export {
  customDevRpcRequest
};
